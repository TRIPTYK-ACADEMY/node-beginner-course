<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/league.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

        <section>
          <h1>Node.js Débutant</h1>
          <img src="img/1200px-node.js.png" width="400" />
          <p>&copy; 2018 Triptyk SPRL</p>
        </section>

        <!-- 1. Introduction -->

        <section>

          <section>
            <h2>1. Introduction</h2>
          </section>
          
          <!-- 1.1 -->
          <section>
            <h3>Qu'est-ce que c'est ?</h3>
          </section>
            
          <section>
            Environnement d'exécution Javascript construit sur le moteur JavaScript V8 de Chrome. 
          </section>
            
          <section>
            Environnement bas niveau permettant l’exécution de JavaScript côté serveur.
          </section>

          <!-- 1.2 -->
          <section>
            <h3>Avantages</h3>
          </section>
          
          <section>
            <ul>
              <li class="fragment" data-fragment-index="1">Basé sur l’événementiel et des entrées/sorties non bloquantes, ce qui le rend léger et efficace.</li>
              <li class="fragment" data-fragment-index="2">Ultra-rapide !</li>
              <li class="fragment" data-fragment-index="3">Le plus grand écosystème (npm) de bibliothèques open source au monde !</li>
              <li class="fragment" data-fragment-index="4">Coûts de production très bas par rapport aux technologies concurrentes.</li>
            </ul>
           </section>
         

          <!-- 1.3 -->
          <section>
            <h3>Inconvénients</h3>
          </section>
          
          <section>
            <ul>
              <li class="fragment" data-fragment-index="1">Fragilité du langage Javascript et de la programmation fonctionnelle vs la programmation orientée objet.</li>
              <li class="fragment" data-fragment-index="2">Grosse exposition aux hackers.</li>
              <li class="fragment" data-fragment-index="3">Le bon côtoie le moins bon.</li>
            </ul>
          </section>

          <!-- 1.4 -->
          <section>
            <h3>Historique</h3>
          </section>
          
          <section>
            <p>
                Node.js a été créé par Ryan Dahl en 2009, qui a eu cette idée après avoir observé la barre de progression d'un chargement de 
                fichier : le navigateur ne savait pas quel pourcentage du fichier était chargé, et devait interroger le serveur web. 
                Dahl voulait développer une méthode plus simple et quand le moteur V8 fut diffusé, il commença à s'intéresser à JS : node.js était né !
            </p>
            <cite>Wikipédia - <a href="https://fr.wikipedia.org/wiki/Node.js" target="_blank">https://fr.wikipedia.org/wiki/Node.js</a></cite>
          </section>

           <!-- 1.5 -->
          <section>
            <h3>Environnement</h3>
          </section>
          
          <section>
            <ul>
              <li>OS Linux Ubuntu 16.04</li>
              <li>Visual Studio Code</li>
              <li>Terminal + ZSH</li>
            </ul>
          </section>

          <!-- 1.6 -->
          <section>
            <h3>Installation sous Linux Ubuntu 16.04</h3>
          </section>
          
          <section>
            <pre class="bash"><code data-trim data-noescape>
              $ sudo apt-get update
              $ sudo apt-get install nodejs
              $ nodejs -v
            </code></pre>
          </section>

          <!-- 1.7 -->
          <section>
            <h3>Fonctionnement</h3>
          </section>
          
          <section>
            <p>Philosophie différente des autres types de serveurs (Apache, Nginx, IIS, ...)</p>
          </section>

          <section>
            <p>Un seul et unique thread</p>
          </section>

          <section>
            <p>Et pourtant, c'est ultra-rapide ...</p>
          </section>

          <section>
            <p>Comment est-ce possible ?</p> 
          </section>

          <section>
            <p>Grâce à la gestion des <strong>EVENEMENTS</strong> !</p>
          </section>

          <section>
            <figure>
                <img src="img/node.js-server.png" alt="" />
                <figcaption>
                    <cite>
                        @ <a href="https://www.dotnettricks.com/learn/nodejs/nodejs-vs-other-server-side-frameworks" target="_blank">dotnettricks</a>
                    </cite>
                </figcaption>
            </figure>
          </section>

          <section>
            <p>Conséquences</p>
            <ul>
              <li class="fragment" data-fragment-index="1">Encore une fois ... c'est rapide !</li>
              <li class="fragment" data-fragment-index="2">Pas possible d'écrire du code procédural.</li>
              <li class="fragment" data-fragment-index="3">Il faudra écrire des traitements les plus courts possibles, pour ne pas bloquer le thread principal.</li>
            </ul>
          </section>

          <section>
            <p>Les programmes node.js seront écrits en JavaScript, et exécutés via la commande node</p>
            <pre class="bash"><code data-trim data-noescape>
                $ node app.js
              </code></pre>
          </section>
        </section>
        
         <!-- 2. Utilisation en ligne de commande -->

        <section>

          <section>
            <h2>2. Premiers pas</h2>
          </section>

          <!-- 2.1 -->
          <section>
            <h3>Hello World</h3>
          </section>

          <section>
            <pre class="bash"><code data-trim data-noescape>
              $ cd /var/www/
              $ mkdir node-beginners && cd node-beginners 
              $ mkdir Exo-01 && cd Exo-01
              $ touch index.js 
              $ code index.js
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              console.log('Hello World !');
            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js
            </code></pre>
          </section>

          <!-- 2.2 -->
          <section>
            <h3>Variables locales</h3>
          </section>
          <section>
            <ul>
              <li>Variables scopées</li>
              <li>Scope limité au module (fichier)</li>
            </ul>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              let myString = 'My String';
              console.log(myString); // My String
            </code></pre>
          </section>

          <!-- 2.3 -->
          <section>
            <h3>Variables globales</h3>
          </section>
          <section>
              <ul>
                <li>Objet global embarque des objets natifs utiles</li>
                <li>Scope étendu au contexte d'exécution</li>
              </ul>
            </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              console.log(global);
            </code></pre>
          </section>
          <section>
            <p>Possible d'hydrater l'objet global avec des variables personnalisées</p>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              global.myVariable = 'Toto';
              global.myFunction = function(name) { 
                if(!name) return false; 
                console.log(`Hello ${name}`); 
              };
              console.log(global);
              console.log(global.myVariable);
              global.myFunction('Steve');
            </code></pre>
          </section>
          <section>
            <p>A noter : il n'existe pas d'objet window dans l'environnement node</p>
          </section>

          <!-- 2.4 -->
          <section>
            <h3>Arguments</h3>
          </section>
          <section>
            <p>Il est possible de récupérer les arguments qui sont passés au script lors de son démarrage.</p>
          </section>
          <section>
            <p>process.argv</p>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              function collectName() {
                if(typeof(process.argv(['name']) === 'undefined')) 
                  return 'Pas de nom trouvé';
                else 
                  return `Hello ${process.argv['name']}`;
              }
              const output = collectName();
              console.log(output);
            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js --name Steve // Hello Steve
              $ node index.js --message Hello // Pas de nom trouvé
            </code></pre>
          </section>

          <!-- 2.5 -->
          <section>
            <h3>Utiliser les entrées/sorties</h3>
          </section>
          <section>
            <p>Il est possible de manipuler les entrées/sorties du terminal.</p>
          </section>
          <section>
            <p>process.stdin / process.stdout</p>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              process.stdout.write('Hello World');
            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js 
            </code></pre>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              process.stdin.on('data', function(data) {
                process.stdout.write('Data received');
              });
            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js 
            </code></pre>
          </section>
          <section>
            <h4>Exercice</h4>
          </section>
          <section>
            <p>
              A l'aide de process.stdout et process.stdin, écrire un programme qui va poser trois questions à l'utilisateur, enregistrer ses réponses et,
              une fois le process terminé, va afficher le récapitulatif et un indice calculé, au choix.
            </p>
          </section>
          <section>
            <p>Version procédurale</p>
            <pre class="javascript"><code data-trim data-noescape>
              
              const questions = [
                'What\'s your name ? \n', 
                'What\'s your favorite animal ? \n',
                'What\'s your favorite color ? \n'
                ];
              
              const responses = [];
              let cursor = 0;
              
              const ask = function() {
                process.stdout.write(questions[cursor]);
              };
              
              const resume = function() {
                let loopCycle = questions.length;
                let i = 0;
                process.stdout.write('------------------------- \n');
                process.stdout.write('Resume of the interview : \n');
                process.stdout.write('------------------------- \n');
                for(i ; i < loopCycle ; i++) {
                  process.stdout.write(responses[i]);
                }
                process.stdout.write('Sorry dude, bad responses. \n');
                process.exit();
              };
              
              process.stdin.on('data', function(data) {
                responses.push(data); 
                cursor++;
                cursor < ( questions.length ) ? ask() : resume();
              });
              
              ask();

            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js 
            </code></pre>
          </section>
          <section>
            <p>Version "objet" en JS à papa</p>
            <pre class="javascript"><code data-trim data-noescape>
              
              const JokeManager = function() {

              let responses = [], cursor = 0;
              
              const questions = [
                'What\'s your name ? \n', 
                'What\'s your favorite animal ? \n',
                'What\'s your favorite color ? \n'
              ];
            
              const init = function() {
                listen();
                ask();
              };
            
              const ask = function() {
                process.stdout.write(questions[cursor]);
              };
              
              const listen = function() {
                process.stdout.write('We listen the terminal\n');
                process.stdin.on('data', function(data) {
                  responses.push(data); 
                  cursor++;
                  cursor < ( questions.length ) ? ask() : resume();
                });
              };
            
              const resume = function() {
                let loopCycle = questions.length;
                let i = 0;
                process.stdout.write('------------------------- \n');
                process.stdout.write('Resume of the interview : \n');
                process.stdout.write('------------------------- \n');
                for(i ; i < loopCycle ; i++) {
                  process.stdout.write(responses[i]);
                }
                process.stdout.write('Sorry dude, bad responses. \n');
                process.exit();
              };
            
              let self = this;
              self.init = init;
            
              return self;
            };
            
            global.utils = {};
            global.utils.JokeManager = JokeManager();
            
            utils.JokeManager.init();

            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js 
            </code></pre>
          </section>

          <!-- 2.6 -->
          <section>
            <h3>Gérer le timing</h3>
          </section>
        
          <section>
            <pre class="bash"><code data-trim data-noescape>
              $ cd /var/www/node-beginners/
              $ mkdir Exo-03 && cd Exo-03
              $ touch index.js 
              $ code index.js
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              console.log('Hello World !');
              setTimeout(function() {
                console.log('Sorry, the good string would be displayed in 3 seconds ...');
              }, 2000);
              setTimeout(function() {
                console.log('Hello Technocité');
              }, 5000);
            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js
            </code></pre>
          </section>
     
        </section>

        <!-- 3. Gestion des modules -->

        <section>

          <section>
            <h2>3. Gestion des modules</h2>
          </section>
  
          <!-- 3.1 -->
          <section>
              <h3>Les modules natifs</h3> 
          </section>
          <section>
            <ul>
              <li>Clairement plus orientés bas niveau</li>
              <li>Font partie du coeur node.js</li>
              <li>Sont accessibles globalement</li>
            </ul>
          </section>
          <section>
            <p>RTFM</p>
            <p>
              <a href="https://nodejs.org/api/">https://nodejs.org/api/</a>
            </p>
            <p>La caverne d'Ali Baba du développeur node.js</p>
          </section>
          <section>
            <p>Une instruction javascript pour les utiliser :</p>
            <pre class="javascript"><code data-trim data-noescape>
                require()
            </code></pre>
          </section>
          <section>
            <p>Exercice</p>
          </section>
          <section>
            <p>Nous souhaitons pouvoir faire des vérifications quant au type des variables que nous utilisons dans un script.</p>
          </section>
          <section>
            <p class="fragment" data-fragment-index="1">Diantre.</p> 
            <p class="fragment" data-fragment-index="2">Fichtre.</p> 
            <p class="fragment" data-fragment-index="3">Enfer et damnation.</p>
            <p class="fragment" data-fragment-index="4">Comment faire ?</p>  
          </section>
          <section>
            <p>La doc est ton amie</p>
            <p>
              <a href="https://nodejs.org/api/util.html#util_util_types">
                https://nodejs.org/api/util.html#util_util_types
              </a>
            </p>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              const Util = require('util');
            </code></pre>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              let stringToTest = 'Technocité';
              console.log(Util.types.isStringObject(stringToTest)); // false
            </code></pre>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              let stringToTest = new String('Technocité');
              console.log(Util.types.isStringObject(stringToTest)); // true
            </code></pre>
          </section>

          <!-- 3.2 -->
          <section>
            <h3>Les paquets node.js</h3> 
          </section>
          <section>
            <ul>
              <li>Bas niveau et features</li>
              <li>Accessibles globalement après installation</li>
              <li>Quasiment tout ce que vous voulez a déjà été fait</li>
              <li>Chargés via le Node Package Manager (npm)</li>
            </ul>
          </section>
          <section>
            <h4>Node Package Manager</h4>
            <p>Fondamental dans l'environnement node.js</p>
          </section>
          <section>
            <p>Installation</p>
            <pre class="bash"><code data-trim data-noescape>
              $ sudo apt-get install npm
              $ npm -v
              $ npm -h
            </code></pre>
          </section>
          <section>
            <p>Installer un paquet localement avec npm</p>
            <pre class="bash"><code data-trim data-noescape>
              $ npm install mon-bo-paquet --save
            </code></pre>
          </section>
          <section>
            <p>Installer un paquet globalement avec npm</p>
            <pre class="bash"><code data-trim data-noescape>
              $ npm install mon-bo-paquet-global -g
            </code></pre>
          </section>
          <section>
            <p>Comme toujours, RTFM</p>
            <p>
              <a href="https://docs.npmjs.com/">
                https://docs.npmjs.com/
              </a>
            </p>
          </section>
          <section>
            <h4>Exercices</h4>
          </section>
          <section>
            <p>
              Utiliser le module colors pour afficher des messages en couleur dans la console. Il faut pouvoir utiliser ce module 
              dans tous les projets node.js.
            </p>
          </section>
          <section>
            <pre class="bash"><code data-trim data-noescape>
              $ mkdir Exo-03 && cd Exo-03 
              $ touch app.js
              $ npm install colors -g
              $ code app.js
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              const Colors = require('colors');
              try {
                let test = 'String to test';
                test.relace('test', 'break');
              }
              catch(e) { console.log(e.message.red); };
            </code></pre>
          </section>
          <section>
            <p>
              Utiliser le module keyword-extractor pour recenser les occurrences de mots dans un contenu textuel.
            </p>
          </section>
          <section>
            <pre class="bash"><code data-trim data-noescape>
              $ mkdir Exo-04 && cd Exo-04 
              $ touch app.js
              $ npm install keyword-extractor --save
              $ code app.js
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              const KeywordsExtractor = require('keyword-extractor');
              try {
                const text = 'This is an string wich contains some words. Each word build the string, and the string is nothing without words.';
                const extract = KeywordsExtractor.extract(text, {
                  language: 'english',
                  remove_duplicates: false
                });
                console.log(extract);
              }
              catch(e) { e.message.red };
            </code></pre>
          </section>
          <section>
            <h4>Le fichier package.json</h4>
          </section>
          <section>
            <ul>
              <li>Crucial pour le versionnement et la maintenabilité</li>
              <li>Contient toutes les dépendances du projet</li>
              <li>Généré dès l'initialisation</li>
              <li>Mis à jour en permanence</li>
            </ul>
          </section>
          <section>
            <pre class="bash"><code data-trim data-noescape>
              $ mkdir Exo-03 && cd Exo-03 
              $ npm init
            </code></pre>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              {
                "name": "package-json-sample",
                "version": "1.0.0",
                "description": "Basis package.json sample",
                "main": "app.js",
                "scripts": {
                  "test": "echo \"Error: no test specified\" && exit 1"
                },
                "author": "Steve Lebleu",
                "keywords": "package, package.json, repository",
                "license": "MIT"
              }
            </code></pre>
          </section>
          <section>
            <p>Le fichier peut être édité manuellement, et sera mis à jour lorsque :</p>
            <ul>
              <li>Un package sera installé en tant que dépendance directe : --save</li>
              <li>Un package sera installé en tant que dépendance de développement : --save-dev</li>
            </ul>
          </section>
          

          <!-- 3.3 -->

          <section>
            <h3>Modules custom</h3>
          </section>
          <section>
            <p>Parce que tout n'existe pas tout fait ...</p>
          </section>
          <section>
            <p>Il est parfois nécessaire/utile/sympa de développer un module !</p>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              module.exports = () => {
                console.log('Hello, i am a module !');
              };
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              const myExport = require('');
              myExport();
            </code></pre>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              module.exports = (name) => {
                console.log(`Hello ${name}, i am a module !`);
              };
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              const myExport = require('');
              myExport('Toto');
            </code></pre>
          </section>
          <section>
            <pre class="javascript"><code data-trim data-noescape>
              export.yourFunctionOne = () => {
                console.log('Hello, i am the first function in a module !');
              }
              export.yourFunctionTwo = (parameter) => {
                console.log('Hello, i am the second function in a module, and i have a parameter !');
                console.log(`The parameter value is : ${parameter}`);
              }
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              const myExport = require('');
              myExport.yourFunctionOne();
              myExport.yourFunctionTwo(123);
            </code></pre>
          </section>
          <section>
            <h4>Exercice</h4>
          </section>
          <section>
            <p>Reprendre le module JS AskManager et en faire un vrai module node.</p>
          </section>
          <section>
          <pre class="javascript"><code data-trim data-noescape>
            module.exports = function() {

              let responses = [], cursor = 0;
              
              const questions = [
                'What\'s your name ? \n', 
                'What\'s your favorite animal ? \n',
                'What\'s your favorite color ? \n'
              ];
            
              const init = function() {
                listen();
                ask();
              };
            
              const ask = function() {
                process.stdout.write(questions[cursor]);
              };
              
              const listen = function() {
                process.stdout.write('We listen the terminal\n');
                process.stdin.on('data', function(data) {
                  responses.push(data); 
                  cursor++;
                  cursor < ( questions.length ) ? ask() : resume();
                });
              };
            
              const resume = function() {
                let loopCycle = questions.length;
                let i = 0;
                process.stdout.write('------------------------- \n');
                process.stdout.write('Resume of the interview : \n');
                process.stdout.write('------------------------- \n');
                for(i ; i < loopCycle ; i++) {
                  process.stdout.write(responses[i]);
                }
                process.stdout.write('Sorry dude, bad responses. \n');
                process.exit();
              };
            
              let self = this;
              self.init = init;
            
              return self;
            };
            </code></pre>
            <pre class="javascript"><code data-trim data-noescape>
              const AskManager = require(__dirname + '/export-1')();
              AskManager.init();
            </code></pre>
            <pre class="bash"><code data-trim data-noescape>
              $ node index.js 
            </code></pre>
          </section>

        </section>
          
          
         
          <!--
          <section>
              <h3>nvm</h3>
              <p>Gérer différentes versions sur une machine</p>
              <pre class="bash"><code data-trim data-noescape>
                  $ sudo apt-get update
                  $ sudo apt-get install build-essential libssl-dev
                </code></pre>
              <pre class="bash"><code data-trim data-noescape>
                  $ curl -sL https://raw.githubusercontent.com/creationix/nvm/v0.33.8/install.sh -o install_nvm.sh
                </code></pre>
              <pre class="bash"><code data-trim data-noescape>
                  $ bash install_nvm.sh
                </code></pre>
              <pre class="bash"><code data-trim data-noescape>
                  $ source ~/.profile
                </code></pre>
            </section>-->

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
      });
      Reveal.configure({ slideNumber: 'c/t' });
		</script>
	</body>
</html>
